# 智联药箱最终记录
需要记录的点：
## 1 mysql读取数据不能更新
连接后由于默认读取方式是read——commit，所以在query的时候需要执行一次commit，除此之外应该有别的方法。还有就是mysql连接需要修改最大连接时间，默认是八小时好像是，可以改成24天之类的。网上有教程。
## 2 sshtunnel+mysql连接非本地数据库
这个倒不是难点，主要搜这个东西太少人post，所以在这里记录一下
## 3 while循环导致服务器cpu占比100%
解决办法是在while循环中sleep(0.001)，即暂停一毫秒，这一毫秒可以足够把cpu让出来执行其他进程，从而保证cpu占比稳定。
## 4 串口通信
通过USB和AMA进行通信时，数据发送不宜过快，一个是树莓派的性能跟不上，二个是没必要。监测心率和血氧饱和度的时候发送过快导致AMA直接收不到数据。
## 5 tcp通信
1. java进行传输的时候是在语句后面加了一个‘\r\n’的，比要传输的str多了两个元素，所以在用python处理的时候需要加上strip()
2. python发送结果时，需要在语句后面加'\n'，不然java程序会认为语句没有传输完，一直等待接收。
## 6 多线程
mysql多线程实现需要加锁，否则会导致多个客户端对数据库的查询冲突，从而使目前结构下的数据连接失效。
